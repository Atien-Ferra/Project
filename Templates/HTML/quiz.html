{% extends "base.html" %}

{% block title %}Quiz â€¢ Focus Flow{% endblock %}

{% block nav_links %}
    <a class="nav-link" href="{{ url_for('dashboard') }}">Dashboard</a>
    <a class="nav-link active" href="{{ url_for('quiz') }}">Quiz</a>
    <a class="nav-link" href="{{ url_for('logout') }}">Log Out</a>
{% endblock %}

{% block content %}
<div class="py-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1 class="h5 mb-0">Generated Quiz</h1>
        <div>
            <span class="badge text-bg-secondary me-2">5 mins</span>
            <span class="badge text-bg-dark progress-text">0/{{ questions|length }} answered</span>
        </div>
    </div>

    <!-- Progress Bar -->
    <div class="card shadow-sm mb-4">
        <div class="card-body py-3">
            <div class="progress quiz-progress">
                <div class="progress-bar bg-dark quiz-progress-bar" style="width: 0%"></div>
            </div>
        </div>
    </div>

    <form id="quizForm" method="POST">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
        <div class="quiz-container">
        <!-- Dynamically generated questions -->
        {% for question in questions %}
        <div class="card q-card shadow-sm mb-3 question-card {% if loop.first %}active{% endif %}" id="question-{{ loop.index }}" data-question-id="{{ loop.index }}">
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-center mb-2">
                    <div class="small text-secondary">Question {{ loop.index }} of {{ questions|length }}</div>
                    <div class="small text-secondary">{{ question.category }}</div>
                </div>
                <h2 class="h6">{{ question.question_text }}</h2>
                <div class="mt-3">
                    {% for answer in question.answers %}
                    <div class="answer-option" data-answer-id="{{ answer.id }}">
                        <div class="form-check mb-0">
                            <input class="form-check-input" type="radio" name="q{{ question.question_number }}" id="{{ answer.id }}" value="{{ answer.id }}">
                            <label class="form-check-label w-100" for="{{ answer.id }}">{{ answer.text }}</label>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
        {% endfor %}
    </div>

    <div class="d-flex justify-content-between gap-2">
        <a href="{{ url_for('dashboard') }}" class="btn btn-outline-secondary">Back to Dashboard</a>
        <div>
            <button class="btn btn-outline-secondary prev-btn" disabled>Previous</button>
            <button class="btn btn-outline-secondary next-btn" type="button">Next</button>
            <button class="btn btn-dark" id="submitQuiz" type="submit" disabled>Submit Quiz</button>
        </div>
    </div>
    </form>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='JS/quiz.js') }}"></script>
{% endblock %}